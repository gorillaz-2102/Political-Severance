<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Mon Gouvernement Idéal</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@700&family=Dancing+Script&display=swap');

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #002366 33%, #ffffff 34% 66%, #ce1126 67%);
      background-size: cover;
      background-repeat: no-repeat;
    }

    .container {
      max-width: 1150px;
      margin: 0 auto;
      padding: 0;
      background-color: #f5f5f5;
    }

    header {
      width: 100%;
      height: 280px;
      background-color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: auto;
      height: auto;
      max-height: 100%;
      max-width: 100%;
      background-image: url('https://github.com/gorillaz-2102/Political-Severance/raw/main/header_banner.jpg');
      background-repeat: no-repeat;
      background-position: top center;
      background-size: auto;
      background-attachment: local;
    }

    header h1 {
      margin: 0;
      font-size: 2.7em;
      font-weight: bold;
      color: #002366;
      position: relative;
      top: -50px;
      z-index: 1;
    }

    header p {
      font-size: 1em;
      color: #555;
      margin-top: 10px;
      position: relative;
      top: -50px;
      z-index: 1;
    }

    .marge-haut {
      margin-top: 30px;
    }

    .separateur {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 40px 0 20px;
    }

    .separateur::before,
    .separateur::after {
      content: "";
      flex: 1;
      border-bottom: 2px solid #ccc;
    }

    .separateur::before {
      margin-right: 10px;
    }

    .separateur::after {
      margin-left: 10px;
    }

    .separateur span {
      font-size: 2em;
      font-family: 'Dancing Script', cursive;
      color: #444;
    }

    #fonctions,
    #fonctions-ministeres {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      padding: 20px;
    }

    #fonctions-ministeres {
      gap: 18px;
    }

    .fonction {
      display: flex;
      border: 1px solid #d3d4d7;
      background: white;
      overflow: hidden;
      height: 160px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .fonction.large {
      width: 370px;
      border-radius: 10px;
    }

    .fonction.small {
      width: 320px;
      border-radius: 10px;
    }

    .fonction.president {
      border: 3px solid transparent;
      border-radius: 10px;
      background-image: linear-gradient(white, white), linear-gradient(45deg, #FFD700, #FFA500);
      background-origin: border-box;
      background-clip: content-box, border-box;
    }

    .fonction.premier-ministre {
      border: 3px solid transparent;
      border-radius: 10px;
      background-image: linear-gradient(white, white), linear-gradient(45deg, #C0C0C0, #A9A9A9);
      background-origin: border-box;
      background-clip: content-box, border-box;
    }

    .info {
      flex: 1;
      padding: 10px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .titre {
      font-weight: bold;
      font-size: 0.9em;
      line-height: 1.2em;
    }

    .nom-personne {
      color: #002366;
      font-size: 1.6em;
      font-weight: bold;
      font-family: 'Roboto Condensed', sans-serif;
      margin-top: 5px;
      margin-bottom: 5px;
      line-height: 1.2em;
    }

    .image-zone {
      width: 120px;
      background-color: #eee;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      order: -1;
      transition: background-color 0.3s ease;
      font-weight: bold;
      font-size: 5em;
      color: #dcdcdc;
    }

    .small .image-zone {
      width: 100px;
    }

    .image-zone img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transform: translateX(-15px);
      transition: opacity 0.5s ease, transform 0.5s ease;
    }

    .image-zone.loaded img {
      opacity: 1;
      transform: translateX(0);
    }

    input[type="text"] {
      margin-bottom: 6px;
      padding: 4px;
    }

    button {
      padding: 5px 10px;
      background-color: #002366;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #001a4d;
    }

    #suggestions {
      position: absolute;
      background: white;
      border: 1px solid #ccc;
      list-style: none;
      padding: 0;
      margin: 0;
      z-index: 1000;
    }

    #suggestions li {
      display: flex;
      align-items: center;
      padding: 5px;
      cursor: pointer;
    }

    #suggestions li:hover {
      background-color: #f0f0f0;
    }

    #suggestions li img {
      width: 30px;
      height: 30px;
      object-fit: cover;
      border-radius: 50%;
      margin-right: 10px;
    }

    .valider-section {
      text-align: center;
      margin: 40px 0;
    }

    .valider-section button {
      font-size: 1.1em;
      padding: 10px 30px;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Mon Gouvernement Idéal</h1>
      <p>Recrute ton équipe de rêve sans contraintes ni jugements</p>
    </header>

    <div class="marge-haut" id="fonctions"></div>

    <div class="separateur"><span>Ministères</span></div>
    <div id="fonctions-ministeres"></div>

    <div class="valider-section">
      <button id="validerBtn">Valider mon gouvernement</button>
    </div>
  </div>

  <ul id="suggestions"></ul>

  <script>
    const postesImportants = [
      { titre: 'Président de la République', id: 'president', classe: 'large president' },
      { titre: 'Premier Ministre', id: 'premier-ministre', classe: 'large premier-ministre' },
    ];

    const ministeres = [
      'Ministre de l’Intérieur', 'Ministre de l’Économie', 'Ministre de l’Éducation',
      'Ministre de la Défense', 'Ministre de la Justice', 'Ministre de la Culture',
      'Ministre de l’Environnement', 'Ministre de la Santé', 'Ministre des Affaires étrangères'
    ];

    function creerBloc(titre, id, classeSupplementaire) {
      const bloc = document.createElement('div');
      bloc.className = `fonction ${classeSupplementaire}`;
      bloc.id = id;

      bloc.innerHTML = `
        <div class="image-zone">?</div>
        <div class="info">
          <div class="titre">${titre}</div>
          <div class="nom-personne">À choisir</div>
          <input type="text" placeholder="Nom..." oninput="rechercherPersonne(this, '${id}')">
        </div>
      `;

      return bloc;
    }

    function initialiser() {
      const containerImportants = document.getElementById('fonctions');
      postesImportants.forEach(poste => {
        containerImportants.appendChild(creerBloc(poste.titre, poste.id, poste.classe));
      });

      const containerMinisteres = document.getElementById('fonctions-ministeres');
      ministeres.forEach((ministere, index) => {
        containerMinisteres.appendChild(creerBloc(ministere, 'ministere' + index, 'small'));
      });
    }

    initialiser();

    async function rechercherPersonne(input, idBloc) {
      const recherche = input.value.trim();
      const suggestions = document.getElementById('suggestions');
      suggestions.innerHTML = '';
      if (recherche.length < 2) return;

      try {
        const responseFr = await fetch(`https://fr.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(recherche)}&format=json&origin=*`);
        const dataFr = await responseFr.json();

        let results = dataFr.query.search;
        if (results.length === 0) {
          const responseEn = await fetch(`https://en.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(recherche)}&format=json&origin=*`);
          const dataEn = await responseEn.json();
          results = dataEn.query.search;
        }

        results.slice(0,5).forEach(result => {
          const li = document.createElement('li');
          li.innerHTML = `<img src="https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg" alt=""> ${result.title}`;
          li.onclick = () => selectionnerPersonne(result.title, idBloc);
          suggestions.appendChild(li);
        });

        const rect = input.getBoundingClientRect();
        suggestions.style.top = `${rect.bottom + window.scrollY}px`;
        suggestions.style.left = `${rect.left + window.scrollX}px`;
      } catch (e) {
        console.error('Erreur API Wikipedia:', e);
      }
    }

    async function selectionnerPersonne(nom, idBloc) {
      const bloc = document.getElementById(idBloc);
      const nomPersonne = bloc.querySelector('.nom-personne');
      const imageZone = bloc.querySelector('.image-zone');

      nomPersonne.textContent = nom;
      imageZone.innerHTML = '?';
      imageZone.classList.remove('loaded');

      try {
        const response = await fetch(`https://fr.wikipedia.org/w/api.php?action=query&titles=${encodeURIComponent(nom)}&prop=pageimages&format=json&pithumbsize=200&origin=*`);
        const data = await response.json();
        const pages = data.query.pages;
        const page = Object.values(pages)[0];

        if (page && page.thumbnail) {
          const img = document.createElement('img');
          img.src = page.thumbnail.source;
          imageZone.innerHTML = '';
          imageZone.appendChild(img);
          setTimeout(() => imageZone.classList.add('loaded'), 10);
        }
      } catch (e) {
        console.error('Erreur chargement image:', e);
      }

      document.getElementById('suggestions').innerHTML = '';
    }
  </script>
</body>
</html>
